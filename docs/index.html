<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gamified Industrial Visit - PDF Viewer</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #1e1e2e 0%, #2d2d44 100%);
      color: #e6e6e6;
      min-height: 100vh;
    }

    header {
      background: linear-gradient(90deg, #1a1a2e 0%, #16213e 100%);
      border-bottom: 2px solid #4f8cff;
      padding: 20px 0;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    header .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    h1 {
      font-size: 2rem;
      color: #4f8cff;
      margin-bottom: 5px;
    }

    .subtitle {
      color: #a0a0a0;
      font-size: 0.95rem;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 30px 20px;
    }

    .controls {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      align-items: center;
      background: #232340;
      padding: 15px 20px;
      border-radius: 8px;
      border: 1px solid #3d3d5c;
    }

    .control-group {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    label {
      color: #b0b0b0;
      font-size: 0.95rem;
      min-width: 100px;
    }

    input[type="number"],
    select {
      padding: 8px 12px;
      background: #1a1a2e;
      color: #e6e6e6;
      border: 1px solid #4f8cff;
      border-radius: 4px;
      font-size: 0.95rem;
      cursor: pointer;
    }

    input[type="number"]:focus,
    select:focus {
      outline: none;
      border-color: #7fb3ff;
      box-shadow: 0 0 8px rgba(79, 140, 255, 0.3);
    }

    button {
      padding: 8px 16px;
      background: #4f8cff;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    button:hover {
      background: #3d6ee0;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(79, 140, 255, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      background: #666;
      cursor: not-allowed;
      opacity: 0.5;
    }

    .viewer-wrapper {
      background: #0f0f1a;
      border: 1px solid #3d3d5c;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    #pdf-container {
      display: flex;
      justify-content: center;
      align-items: center;
      background: #0f0f1a;
      min-height: 600px;
      overflow: auto;
      max-height: 80vh;
    }

    canvas {
      display: block;
      margin: auto;
      max-width: 100%;
      height: auto;
    }

    .page-info {
      text-align: center;
      padding: 10px;
      background: #232340;
      color: #b0b0b0;
      font-size: 0.9rem;
      border-top: 1px solid #3d3d5c;
    }

    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 300px;
      color: #4f8cff;
      font-size: 1.1rem;
    }

    .error {
      background: #3a1a1a;
      color: #ff6b6b;
      padding: 15px 20px;
      border-radius: 4px;
      border-left: 4px solid #ff6b6b;
      margin-bottom: 20px;
    }

    .info-box {
      background: #232340;
      border-left: 4px solid #4f8cff;
      padding: 15px 20px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Gamified Industrial Visit</h1>
      <div class="subtitle">PDF Document Viewer | Zoom, Navigate & View</div>
    </div>
  </header>

  <div class="container">
    <div class="info-box">
      ‚úà Upload your PDF file (name it <strong>document.pdf</strong>) in the docs/ folder and it will display here
    </div>

    <div class="controls">
      <div class="control-group">
        <button id="prev-btn" onclick="previousPage()">‚¨Ö Previous</button>
        <label for="current-page">Page:</label>
        <input type="number" id="current-page" min="1" value="1" onchange="goToPage()">
        <span id="page-count">/ --</span>
      </div>
      <div class="control-group">
        <button id="next-btn" onclick="nextPage()">Next ‚ûú</button>
      </div>
      <div class="control-group">
        <label for="zoom-select">Zoom:</label>
        <select id="zoom-select" onchange="setZoom()">
          <option value="50">50%</option>
          <option value="75">75%</option>
          <option value="100" selected>100%</option>
          <option value="125">125%</option>
          <option value="150">150%</option>
          <option value="200">200%</option>
        </select>
      </div>
      <div class="control-group">
        <button onclick="zoomIn()">üîç+</button>
        <button onclick="zoomOut()">üîç-</button>
      </div>
    </div>

    <div class="viewer-wrapper">
      <div id="pdf-container">
        <div class="loading">Loading PDF viewer...</div>
      </div>
      <div class="page-info">
        <span id="load-info">Initializing PDF.js...</span>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    // PDF.js worker setup
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

    let pdfDoc = null;
    let currentPage = 1;
    let currentZoom = 100;
    let pageRendering = false;
    let pageNumPending = null;

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const container = document.getElementById('pdf-container');

    // Load PDF from docs/document.pdf
    async function loadPDF() {
      try {
        const response = await fetch('document.pdf');
        if (!response.ok) {
          throw new Error('PDF file not found. Please upload document.pdf to the docs/ folder.');
        }
        const arrayBuffer = await response.arrayBuffer();
        pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        document.getElementById('page-count').textContent = '/ ' + pdfDoc.numPages;
        document.getElementById('current-page').max = pdfDoc.numPages;
        renderPage(1);
      } catch (error) {
        container.innerHTML = `<div class="error" style="width: 100%; margin: 20px;"><strong>Error:</strong> ${error.message}</div>`;
        console.error('PDF Error:', error);
      }
    }

    async function renderPage(num) {
      if (pageRendering) {
        pageNumPending = num;
        return;
      }

      if (!pdfDoc) return;

      if (num > pdfDoc.numPages || num < 1) return;

      pageRendering = true;
      currentPage = num;
      document.getElementById('current-page').value = num;

      try {
        const page = await pdfDoc.getPage(num);
        const viewport = page.getViewport({ scale: currentZoom / 100 });
        canvas.width = viewport.width;
        canvas.height = viewport.height;

        const renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };

        await page.render(renderContext).promise;
        container.innerHTML = '';
        container.appendChild(canvas);
        document.getElementById('load-info').textContent = `Page ${num} of ${pdfDoc.numPages}`;

        document.getElementById('prev-btn').disabled = num <= 1;
        document.getElementById('next-btn').disabled = num >= pdfDoc.numPages;
      } catch (error) {
        console.error('Render error:', error);
      }

      pageRendering = false;
      if (pageNumPending !== null) {
        renderPage(pageNumPending);
        pageNumPending = null;
      }
    }

    function nextPage() {
      if (currentPage < pdfDoc.numPages) {
        renderPage(currentPage + 1);
      }
    }

    function previousPage() {
      if (currentPage > 1) {
        renderPage(currentPage - 1);
      }
    }

    function goToPage() {
      const page = parseInt(document.getElementById('current-page').value) || 1;
      renderPage(page);
    }

    function setZoom() {
      currentZoom = parseInt(document.getElementById('zoom-select').value);
      renderPage(currentPage);
    }

    function zoomIn() {
      currentZoom = Math.min(currentZoom + 25, 300);
      document.getElementById('zoom-select').value = currentZoom;
      renderPage(currentPage);
    }

    function zoomOut() {
      currentZoom = Math.max(currentZoom - 25, 50);
      document.getElementById('zoom-select').value = currentZoom;
      renderPage(currentPage);
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') nextPage();
      if (e.key === 'ArrowLeft') previousPage();
    });

    // Load PDF when page loads
    window.addEventListener('load', loadPDF);
  </script>
</body>
</html>
